<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aiden_OS v9.0 | Persistence</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00f2ff;
            --bg: #08090a;
            --window: #141619;
            --border: rgba(255, 255, 255, 0.1);
            --text: #ffffff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }
        body { font-family: 'Space Grotesk', sans-serif; background: #000; color: var(--text); height: 100vh; overflow: hidden; }

        /* --- DESKTOP --- */
        #desktop {
            height: calc(100vh - 50px); width: 100vw; background: var(--bg);
            background-image: radial-gradient(circle, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            position: relative; padding: 20px; display: flex; flex-direction: column; flex-wrap: wrap; gap: 10px; align-content: flex-start;
        }

        .icon {
            width: 85px; text-align: center; cursor: pointer; border-radius: 12px; padding: 10px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); border: 1px solid transparent; z-index: 5;
        }
        .icon:hover { background: rgba(0, 242, 255, 0.1); border-color: var(--primary); transform: translateY(-5px); }
        .icon-img { font-size: 2.2rem; margin-bottom: 5px; display: block; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.5)); }
        .icon span { font-size: 0.7rem; font-weight: 600; text-shadow: 0 2px 4px #000; display: block; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* --- WINDOWS --- */
        .window {
            position: absolute; width: 600px; height: 400px; background: var(--window);
            border: 1px solid var(--border); border-radius: 12px; display: none;
            flex-direction: column; box-shadow: 0 40px 80px rgba(0,0,0,0.8); z-index: 100;
            backdrop-filter: blur(20px); overflow: hidden;
        }
        .win-head {
            height: 40px; background: rgba(255,255,255,0.05); display: flex; 
            align-items: center; padding: 0 15px; cursor: move; justify-content: space-between;
        }
        .win-title { font-size: 0.75rem; font-weight: 800; color: var(--primary); letter-spacing: 1px; }
        .win-dot { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; background: #ff5f56; }
        .win-body { flex: 1; overflow-y: auto; position: relative; padding: 15px; }

        /* --- TASKBAR --- */
        #taskbar {
            height: 50px; background: rgba(0,0,0,0.9); position: fixed; bottom: 0; width: 100%;
            display: flex; align-items: center; justify-content: space-between; padding: 0 20px;
            border-top: 1px solid var(--border); z-index: 2000;
        }
        #clock { font-family: 'Fira Code'; font-size: 0.8rem; font-weight: bold; color: var(--primary); }
        .start-menu { padding: 5px 15px; background: var(--primary); color: #000; border-radius: 5px; font-weight: 900; cursor: pointer; }

        /* --- APPS --- */
        #editor { width: 100%; height: 90%; background: #000; color: #0f0; font-family: 'Fira Code'; border: none; padding: 10px; resize: none; outline: none; }
        .browser-top { display: flex; gap: 10px; margin-bottom: 10px; }
        #url-bar { flex: 1; background: #222; border: 1px solid #444; color: #fff; padding: 5px 10px; border-radius: 4px; outline: none; }
        iframe { width: 100%; height: calc(100% - 40px); border: none; background: #fff; }

        .hidden { display: none; }
    </style>
</head>
<body onload="loadOS()">

    <div id="desktop"></div>

    <div id="taskbar">
        <div class="start-menu" onclick="resetOS()">FACTORY RESET</div>
        <div id="active-apps" style="display:flex; gap:10px; margin-left: 20px;"></div>
        <div id="clock">00:00:00</div>
    </div>

    <div id="win-template" class="window">
        <div class="win-head">
            <span class="win-title">App</span>
            <div class="win-dot" onclick="this.closest('.window').style.display='none'"></div>
        </div>
        <div class="win-body"></div>
    </div>

    <script>
        const APP_DATA = [
            { id: 'about', name: 'About Me', icon: 'üë§', content: '<h1>Aiden Becker</h1><p>Welcome to v9.0.</p>' },
            { id: 'browser', name: 'Quantum Browser', icon: 'üåê', type: 'browser' },
            { id: 'notes', name: 'Aiden Notes', icon: 'üìù', type: 'editor' },
            { id: 'music', name: 'Nevermind Player', icon: 'üíø', content: '<h3>My Songs</h3><p>Restored 4 tracks...</p>' },
            { id: 'terminal', name: 'Root Terminal', icon: 'üìü', type: 'terminal' },
            { id: 'store', name: 'App Store', icon: 'üõçÔ∏è', content: '<h3>Marketplace</h3><p>All apps pre-installed in v9.</p>' },
            { id: 'files', name: 'Explorer', icon: 'üìÇ', content: '<h3>Disk C:</h3><p>System32<br>Users<br>Nevermind_Art</p>' },
            { id: 'settings', name: 'Settings', icon: '‚öôÔ∏è', content: '<h3>System Settings</h3><p>Theme: Cyanide (Locked)</p>' },
            { id: 'calc', name: 'Calculator', icon: 'üî¢', content: '<input type="text" style="width:100%; padding:10px;"><p>Result: 0</p>' },
            { id: 'calendar', name: 'Calendar', icon: 'üìÖ', content: '<h3>January 2026</h3><p>Today is Thursday 22nd.</p>' },
            { id: 'mail', name: 'Mail', icon: '‚úâÔ∏è', content: '<h3>Inbox (2)</h3><p>Welcome to Aiden_OS!</p>' },
            { id: 'photos', name: 'Gallery', icon: 'üñºÔ∏è', content: '<p>Loading images...</p>' },
            { id: 'clock_app', name: 'World Clock', icon: 'üïí', content: '<h3>GMT +0</h3><p>New York: 13:53</p>' },
            { id: 'weather', name: 'Weather', icon: 'üå§Ô∏è', content: '<h3>Novi, MI</h3><p>72¬∞F - Mostly Sunny</p>' },
            { id: 'news', name: 'OS News', icon: 'üì∞', content: '<h3>Aiden_OS v9 Live!</h3><p>New saving system added.</p>' },
            { id: 'chat', name: 'Aiden Chat', icon: 'üí¨', content: '<h3>Global Chat</h3><p>Aiden: Hello world!</p>' },
            { id: 'snake', name: 'Snake Pro', icon: 'üêç', content: '<p>Launch game from Terminal (type "snake")</p>' },
            { id: 'health', name: 'Sys Health', icon: 'üîã', content: '<h3>Battery: 98%</h3><p>Power Source: AC</p>' },
            { id: 'maps', name: 'Aiden Maps', icon: 'üó∫Ô∏è', content: '<p>GPS Signal Found.</p>' },
            { id: 'trash', name: 'Trash', icon: 'üóëÔ∏è', content: '<p>Empty.</p>' }
        ];

        let OS_STATE = {
            installed: APP_DATA.map(a => a.id),
            positions: {},
            noteBuffer: ""
        };

        function saveOS() {
            localStorage.setItem('AIDEN_OS_V9', JSON.stringify(OS_STATE));
        }

        function loadOS() {
            const saved = localStorage.getItem('AIDEN_OS_V9');
            if (saved) OS_STATE = JSON.parse(saved);
            renderDesktop();
            updateClock();
            setInterval(updateClock, 1000);
        }

        function renderDesktop() {
            const desk = document.getElementById('desktop');
            desk.innerHTML = '';
            OS_STATE.installed.forEach(appId => {
                const app = APP_DATA.find(a => a.id === appId);
                const div = document.createElement('div');
                div.className = 'icon';
                div.onclick = () => openApp(app);
                div.innerHTML = `<span class="icon-img">${app.icon}</span><span>${app.name}</span>`;
                desk.appendChild(div);
            });
        }

        function openApp(app) {
            let win = document.getElementById(`win-${app.id}`);
            if (!win) {
                win = document.getElementById('win-template').cloneNode(true);
                win.id = `win-${app.id}`;
                win.querySelector('.win-title').innerText = app.name;
                const body = win.querySelector('.win-body');
                
                if (app.type === 'editor') {
                    body.innerHTML = `<textarea id="editor" oninput="OS_STATE.noteBuffer=this.value; saveOS()">${OS_STATE.noteBuffer}</textarea>`;
                } else if (app.type === 'browser') {
                    body.innerHTML = `
                        <div class="browser-top">
                            <input id="url-bar" value="https://wikipedia.org">
                            <button onclick="document.getElementById('frame-${app.id}').src=document.getElementById('url-bar').value">Go</button>
                        </div>
                        <iframe id="frame-${app.id}" src="https://wikipedia.org"></iframe>`;
                } else {
                    body.innerHTML = app.content || 'System error: Content missing.';
                }

                document.body.appendChild(win);
                makeDraggable(win);
            }
            
            win.style.display = 'flex';
            win.style.zIndex = Math.floor(Date.now() / 1000);
            
            // Restore position if exists
            if (OS_STATE.positions[app.id]) {
                win.style.left = OS_STATE.positions[app.id].x + 'px';
                win.style.top = OS_STATE.positions[app.id].y + 'px';
            } else {
                win.style.left = '100px'; win.style.top = '100px';
            }
        }

        function makeDraggable(el) {
            const head = el.querySelector('.win-head');
            head.onmousedown = (e) => {
                el.style.zIndex = Math.floor(Date.now() / 1000);
                let ox = e.clientX - el.offsetLeft, oy = e.clientY - el.offsetTop;
                document.onmousemove = (e) => {
                    let x = e.clientX - ox, y = e.clientY - oy;
                    el.style.left = x + 'px'; el.style.top = y + 'px';
                    const appId = el.id.replace('win-', '');
                    OS_STATE.positions[appId] = { x, y };
                    saveOS();
                };
                document.onmouseup = () => { document.onmousemove = null; };
            };
        }

        function updateClock() {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        }

        function resetOS() {
            if (confirm("Factory Reset? All data and positions will be cleared.")) {
                localStorage.removeItem('AIDEN_OS_V9');
                location.reload();
            }
        }
    </script>
</body>
</html>
